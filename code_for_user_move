#include <Servo.h>

int val;
const int cain1 = 0,
          cain2 = 0;
          
const int picin1 = 0,
          picin2 = 0;
          // надо будет поставить реальные пины
const int picout1 = 0,
          picout2 = 0;
          
const int caout1 = 0,
          caout2 = 0;
          
const int pupupu = 0; // серво

void setup() {
    Serial1.begin(9600);
    pinMode(4, OUTPUT);
    pinMode(5, OUTPUT);
    pinMode(6, OUTPUT);
    pinMode(7, OUTPUT);
}


void move_(int sp_l, int sp_r){
  digitalWrite(4, sp_l < 0);
  digitalWrite(7, sp_r < 0);

  analogWrite(5, constrain(abs(sp_l), 0, 255));
  analogWrite(6, constrain(abs(sp_r), 0, 255));
}

void cpin(bool is) {
    digitalWrite(cain1, is == 1);
    digitalWrite(cain2, is == 0);
    delay(50);

    digitalWrite(cain1, 0);
    digitalWrite(cain2, 0);
}

void pickin(bool is) {
    digitalWrite(picin1, is == 1);
    digitalWrite(picin2, is == 0);
    delay(100);

    digitalWrite(picin1, 0);
    digitalWrite(picin2, 0);
}

void cpout(bool is) {
    digitalWrite(caout1, is == 1);
    digitalWrite(caout2, is == 0);
    delay(50);

    digitalWrite(caout1, 0);
    digitalWrite(caout2, 0);
}

void povorotout(bool is) {

  // пока не знаю как реализую потому что не уверен в серво

}

void loop() {
    bool cpinb = true;
    bool picinb = true;
    bool cpoutb = true;
    bool povorotoutb = true;
    if (Serial1.available()) {
        val = Serial1.read(); // 13 - вперед 14 - назад 15 - влево 16 - вправо 17 - стояить; 1 - схватить/отпустить внутренним 2 - поднять/опустить внутренним 3 - схватить/отпустить внешним 4 - назад/вперед внешним 
        switch (val) {
            case 13:
                move_(100, 100);
                break;
            case 14:
                move_(-100, -100);
                break;
            case 15:
                move_(0, 100);
                break;
            case 16:
                move_(100, 0);
                break;
            case 17:
                move_(0, 0);
                break;
            case 1:
                cpin(cpinb);
                cpinb = cpinb - 1;
                break;
            case 2:
                pickin(picinb);
                picinb = picinb - 1;
                break;
            case 3:
                cpout(cpoutb);
                cpoutb = cpoutb - 1;
                break;
            case 4:
                povorotout(povorotoutb);
                povorotoutb -= 1;
                break;
        }
    }
}
